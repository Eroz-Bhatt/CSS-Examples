<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scroll Progress Circle</title>
    <style>
        body{
            background-color: white;
        }

        .blok:nth-of-type(odd) {
            background-color:white;
            height: 600px;
        }
            
        .blok:nth-of-type(even) {
            background-color:black;
            height: 600px;
        }

        .paginacontainer {
            height: 3000px;
        }

        /* #Progress
        ================================================== */

        .progress-wrap {
            position: fixed;
            right: 30px;
            bottom: 30px;
            height: 46px;
            width: 46px;
            cursor: pointer;
            display: block;
            border-radius: 50px;
            box-shadow: inset  0 0 0 2px rgba(0,0,0,0.1);
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transform: translateY(15px);
            transition: all 0.3s ease;
            background: transparent; /* Ensure no background */
        }
        .progress-wrap.active-progress {
            opacity: 1;
            visibility: visible;
        }
        .progress-wrap::after {
            position: absolute;
            font-family: 'unicons';
            content: '\e84b';
            text-align: center;
            line-height: 46px;
            font-size: 24px;
            color: rgba(0, 0, 0, 0.3); /* --- Pijl kleur --- */
            left: 0;
            top: 0;
            height: 46px;
            width: 46px;
            cursor: pointer;
            display: block;
            z-index: 1;
            font-family: Arial, sans-serif;
            content: '↑'; /* Fallback arrow */
            transition: all 0.3s ease;
        }
        .progress-wrap:hover::after {
            opacity: 0;
        }
        .progress-wrap::before {
            position: absolute;
            font-family: 'unicons';
            content: '\e84b';
            text-align: center;
            line-height: 46px;
            font-size: 24px;
            opacity: 0;
            left: 0;
            top: 0;
            height: 46px;
            width: 46px;
            cursor: pointer;
            display: block;
            z-index: 2;
            font-family: Arial, sans-serif;
            content: '↑'; /* Fallback arrow */
            transition: all 0.3s ease;
            /* Removed background color change */
        }
        .progress-wrap:hover::before {
            opacity: 1;
            /* Only change opacity, not color */
        }
        .progress-wrap svg path { 
            fill: none; 
        }
        .progress-wrap svg.progress-circle path {
            stroke: rgba(0, 0, 0, 0.2); /* --- Lijn progres kleur --- */
            stroke-width: 4;
            box-sizing:border-box;
            stroke-dasharray: 308; /* Circumference of circle */
            stroke-dashoffset: 308; /* Initially hidden */
            transition: stroke 0.3s ease;
        }
        
        /* Light mode (default) */
        .progress-wrap.light-mode {
            box-shadow: inset 0 0 0 2px rgba(0,0,0,0.1);
        }
        .progress-wrap.light-mode::after {
            color: rgba(0, 0, 0, 0.3);
        }
        .progress-wrap.light-mode::before {
            color: black; /* Changed from background to color */
        }
        .progress-wrap.light-mode svg.progress-circle path {
            stroke: rgba(0, 0, 0, 0.2);
        }
        
        /* Dark mode */
        .progress-wrap.dark-mode {
            box-shadow: inset 0 0 0 2px rgba(255,255,255,0.3);
        }
        .progress-wrap.dark-mode::after {
            color: rgba(255, 255, 255, 0.7);
        }
        .progress-wrap.dark-mode::before {
            color: white; /* Changed from background to color */
        }
        .progress-wrap.dark-mode svg.progress-circle path {
            stroke: rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body>
    <div class="paginacontainer">	
        <div class="blok"></div>
        <div class="blok"></div>
        <div class="blok"></div>
        <div class="blok"></div>
        <div class="blok"></div>

        <div class="progress-wrap active-progress">
            <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
            </svg>
        </div>
    </div>

    <!-- GSAP Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollToPlugin.min.js"></script>
    
    <script>
        // Register plugins
        gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

        // Calculate circle circumference
        const circle = document.querySelector('.progress-circle path');
        const circumference = 2 * Math.PI * 49; // 2πr where r=49
        circle.style.strokeDasharray = circumference;
        circle.style.strokeDashoffset = circumference;

        // circular progress drawing
        gsap.to('.progress-wrap path', {
            strokeDashoffset: 0,
            scrollTrigger: {
                trigger: ".paginacontainer",
                start: 0,
                end: "bottom bottom",
                scrub: true
            }
        });

        // show/hide
        gsap.fromTo(".progress-wrap", {
            yPercent: 100,
            autoAlpha: 0
        }, {
            yPercent: 0,
            autoAlpha: 1,
            scrollTrigger: {
                start: 5,
                toggleActions: "play none none reverse"
            }
        });

        // on click, scroll back to top
        document.querySelector('.progress-wrap').addEventListener("click", (e) => {
            gsap.to(window, {
                scrollTo: 0,
                duration: 0.55
            });
        });

        // Color switching based on background
        const progressWrap = document.querySelector('.progress-wrap');
        const sections = document.querySelectorAll('.blok');
        
        // Set initial state
        progressWrap.classList.add('light-mode');
        
        // Check background color as user scrolls
        function checkBackgroundColor() {
            const progressRect = progressWrap.getBoundingClientRect();
            const progressCenterY = progressRect.top + window.scrollY + (progressRect.height / 2);
            
            let isOnDarkBackground = false;
            
            sections.forEach(section => {
                const sectionRect = section.getBoundingClientRect();
                const sectionTop = sectionRect.top + window.scrollY;
                const sectionBottom = sectionTop + sectionRect.height;
                
                // Check if progress button is over this section
                if (progressCenterY >= sectionTop && progressCenterY <= sectionBottom) {
                    const bgColor = window.getComputedStyle(section).backgroundColor;
                    // Check if background is dark (black)
                    if (bgColor === 'rgb(0, 0, 0)') {
                        isOnDarkBackground = true;
                    }
                }
            });
            
            // Toggle classes for high contrast
            if (isOnDarkBackground) {
                progressWrap.classList.remove('light-mode');
                progressWrap.classList.add('dark-mode');
            } else {
                progressWrap.classList.remove('dark-mode');
                progressWrap.classList.add('light-mode');
            }
        }
        
        // Run on scroll and resize
        window.addEventListener('scroll', checkBackgroundColor);
        window.addEventListener('resize', checkBackgroundColor);
        
        // Initial check
        setTimeout(checkBackgroundColor, 100);
    </script>
</body>
</html>
