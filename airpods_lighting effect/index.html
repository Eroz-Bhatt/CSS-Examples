<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AirPods Pro Scroll Animation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        height: 300vh;
        background: #000;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
          Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        color: #fff;
        overflow-x: hidden;
      }

      canvas {
        position: fixed;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        max-width: 100vw;
        max-height: 100vh;
      }

      .title {
        position: fixed;
        top: 40px;
        left: 50%;
        transform: translateX(-50%);
        text-align: center;
        z-index: 10;
        font-size: 1.8rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 4px;
        background: linear-gradient(90deg, #00c6ff, #0072ff);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .instructions {
        position: fixed;
        bottom: 40px;
        left: 50%;
        transform: translateX(-50%);
        text-align: center;
        z-index: 10;
        color: #aaa;
        font-size: 1rem;
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 0.7;
        }
        50% {
          opacity: 1;
        }
      }

      .product-info {
        position: absolute;
        bottom: 100px;
        left: 40px;
        max-width: 300px;
        background: rgba(0, 0, 0, 0.7);
        padding: 20px;
        border-radius: 10px;
        z-index: 10;
      }

      .product-info h2 {
        font-size: 1.5rem;
        margin-bottom: 10px;
        color: #00a8ff;
      }

      .product-info p {
        font-size: 1rem;
        line-height: 1.5;
        color: #ddd;
        margin-bottom: 15px;
      }

      .product-info ul {
        padding-left: 20px;
        margin-bottom: 15px;
      }

      .product-info li {
        margin-bottom: 8px;
        color: #bbb;
      }

      @media (max-width: 768px) {
        .title {
          font-size: 1.2rem;
          top: 20px;
        }

        .instructions {
          font-size: 0.8rem;
          bottom: 20px;
        }

        .product-info {
          left: 20px;
          right: 20px;
          bottom: 20px;
          max-width: none;
        }
      }
    </style>
  </head>
  <body>
    <div class="title">AirPods Pro Animation</div>
    <canvas id="image-sequence" width="1158" height="770"></canvas>
    <div class="instructions">Scroll to see the animation sequence</div>

    <div class="product-info">
      <h2>AirPods Pro</h2>
      <p>
        Active Noise Cancellation for immersive sound. Transparency mode for
        hearing what's happening around you.
      </p>
      <ul>
        <li>Adaptive EQ automatically tunes music</li>
        <li>Spatial audio with dynamic head tracking</li>
        <li>Sweat and water resistant</li>
        <li>More than 24 hours of battery life</li>
      </ul>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        // Frame count and URL generation
        const frameCount = 147;
        const urls = new Array(frameCount)
          .fill()
          .map(
            (_, i) =>
              `https://www.apple.com/105/media/us/airpods-pro/2019/1299e2f5_9206_4470_b28e_08307a42f19b/anim/sequence/large/01-hero-lightpass/${(
                i + 1
              )
                .toString()
                .padStart(4, '0')}.jpg`
          );

        // Initialize the image sequence
        imageSequence({
          urls,
          canvas: '#image-sequence',
          scrollTrigger: {
            start: 0,
            end: 'max',
            scrub: true,
          },
        });

        // Helper function
        function imageSequence(config) {
          let playhead = { frame: 0 };
          let canvas = document.querySelector(config.canvas);
          let ctx = canvas.getContext('2d');
          let curFrame = -1;
          let onUpdate = config.onUpdate;
          let images;

          // Function to update the canvas with the current frame
          let updateImage = function () {
            let frame = Math.round(playhead.frame);
            if (frame !== curFrame) {
              // Only draw if the frame has changed
              config.clear && ctx.clearRect(0, 0, canvas.width, canvas.height);
              ctx.drawImage(images[frame], 0, 0, canvas.width, canvas.height);
              curFrame = frame;
              onUpdate && onUpdate.call(this, frame, images[frame]);
            }
          };

          // Preload images
          images = config.urls.map((url, i) => {
            let img = new Image();
            img.src = url;
            // Update canvas when first image loads
            if (i === 0) img.onload = updateImage;
            return img;
          });

          // Create the animation timeline
          return gsap.to(playhead, {
            frame: images.length - 1,
            ease: 'none',
            onUpdate: updateImage,
            duration: images.length / (config.fps || 30),
            paused: !!config.paused,
            scrollTrigger: config.scrollTrigger,
          });
        }
      });
    </script>
  </body>
</html>
